"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var chai_1 = require("chai");
var index_1 = require('./index');
var Animal = (function () {
    function Animal(name) {
        this.name = name;
    }
    return Animal;
}());
var Koala = (function (_super) {
    __extends(Koala, _super);
    function Koala() {
        _super.apply(this, arguments);
    }
    Koala.prototype.cutenessLevel = function () {
        return "TO_THE_MAX";
    };
    return Koala;
}(Animal));
function myExtend(d, b) {
    for (var p in b)
        if (b.hasOwnProperty(p))
            d[p] = b[p];
    function Sup() { this.constructor = d; }
    Sup.prototype = b.prototype;
    d.prototype = new Sup();
}
var Person = (function () {
    function Person(name) {
        this.name = name;
    }
    Person.fromJS = function (name) {
        return new Person(name);
    };
    Person.isPerson = function (candidate) {
        return index_1.isInstanceOf(candidate, Person);
    };
    Person.prototype.toString = function () {
        return this.name;
    };
    Person.prototype.valueOf = function () {
        return this.name;
    };
    Person.prototype.toJS = function () {
        return this.name;
    };
    Person.prototype.toJSON = function () {
        return this.name;
    };
    Person.prototype.equals = function (other) {
        return Person.isPerson(other) && this.name === other.name;
    };
    return Person;
}());
describe("utils", function () {
    describe("isInstanceOf", function () {
        it("edge cases", function () {
            chai_1.expect(index_1.isInstanceOf(null, Animal)).to.equal(false);
        });
        it("works within context", function () {
            var animal = new Animal("Garry");
            chai_1.expect(index_1.isInstanceOf(animal, Animal)).to.equal(true);
            chai_1.expect(index_1.isInstanceOf(animal, Koala)).to.equal(false);
            var koala = new Koala("Annie");
            chai_1.expect(index_1.isInstanceOf(koala, Animal)).to.equal(true);
            chai_1.expect(index_1.isInstanceOf(koala, Koala)).to.equal(true);
        });
        it("works with things form other contexts", function () {
            var Animal2 = (function () {
                function Animal(name) {
                    this.name = name;
                }
                return Animal;
            })();
            var Koala2 = (function (_super) {
                myExtend(Koala, _super);
                function Koala(name) {
                    _super.call(this, name);
                }
                Koala.prototype.cutenessLevel = function () {
                    return "TO_THE_MAX";
                };
                return Koala;
            })(Animal2);
            var animal2 = new Animal2("Garry");
            chai_1.expect(index_1.isInstanceOf(animal2, Animal)).to.equal(true);
            chai_1.expect(index_1.isInstanceOf(animal2, Koala)).to.equal(false);
            var koala2 = new Koala2("Annie");
            chai_1.expect(index_1.isInstanceOf(koala2, Animal)).to.equal(true);
            chai_1.expect(index_1.isInstanceOf(koala2, Koala)).to.equal(true);
            var animal = new Animal("Garry");
            chai_1.expect(index_1.isInstanceOf(animal, Animal2)).to.equal(true);
            chai_1.expect(index_1.isInstanceOf(animal, Koala2)).to.equal(false);
            var koala = new Koala("Annie");
            chai_1.expect(index_1.isInstanceOf(koala, Animal2)).to.equal(true);
            chai_1.expect(index_1.isInstanceOf(koala, Koala2)).to.equal(true);
        });
    });
    describe("isArrayOf", function () {
        it("works", function () {
            chai_1.expect(index_1.isArrayOf(null, Animal)).to.equal(false);
            chai_1.expect(index_1.isArrayOf(false, Animal)).to.equal(false);
            chai_1.expect(index_1.isArrayOf("blah", Animal)).to.equal(false);
            chai_1.expect(index_1.isArrayOf(["kitchen"], Animal)).to.equal(false);
            chai_1.expect(index_1.isArrayOf([[], [1], [1, 2]], Array)).to.equal(true);
            chai_1.expect(index_1.isArrayOf([
                new Animal("Tom"),
                new Animal("Jerry"),
                new Koala("Annie")
            ], Animal)).to.equal(true);
        });
    });
    describe("isImmutableClass", function () {
        it("works", function () {
            chai_1.expect(index_1.isImmutableClass(null)).to.equal(false);
            chai_1.expect(index_1.isImmutableClass(false)).to.equal(false);
            chai_1.expect(index_1.isImmutableClass([])).to.equal(false);
            chai_1.expect(index_1.isImmutableClass(Animal)).to.equal(false);
            chai_1.expect(index_1.isImmutableClass(new Person('Bob')), "Person is a Immutable Class").to.equal(true);
        });
    });
    describe("generalEqual", function () {
        it("works with basics (strings)", function () {
            var tom = 'Tom';
            var bob1 = 'Bob';
            var bob2 = 'Bob';
            chai_1.expect(index_1.generalEqual(null, null)).to.equal(true);
            chai_1.expect(index_1.generalEqual(tom, null)).to.equal(false);
            chai_1.expect(index_1.generalEqual(null, tom)).to.equal(false);
            chai_1.expect(index_1.generalEqual(tom, bob1)).to.equal(false);
            chai_1.expect(index_1.generalEqual(bob1, bob2)).to.equal(true);
        });
        it("works with basics (Dates)", function () {
            var tom = new Date('2016');
            var bob1 = new Date('2015');
            var bob2 = new Date('2015');
            chai_1.expect(index_1.generalEqual(null, null)).to.equal(true);
            chai_1.expect(index_1.generalEqual(tom, null)).to.equal(false);
            chai_1.expect(index_1.generalEqual(null, tom)).to.equal(false);
            chai_1.expect(index_1.generalEqual(tom, bob1)).to.equal(false);
            chai_1.expect(index_1.generalEqual(bob1, bob2)).to.equal(true);
        });
        it("works immutables", function () {
            var tom = new Person('Tom');
            var bob1 = new Person('Bob');
            var bob2 = new Person('Bob');
            chai_1.expect(index_1.generalEqual(null, null)).to.equal(true);
            chai_1.expect(index_1.generalEqual(tom, null)).to.equal(false);
            chai_1.expect(index_1.generalEqual(null, tom)).to.equal(false);
            chai_1.expect(index_1.generalEqual(tom, bob1)).to.equal(false);
            chai_1.expect(index_1.generalEqual(bob1, bob2)).to.equal(true);
        });
    });
    describe("immutableEqual", function () {
        it("works immutables", function () {
            var tom = new Person('Tom');
            var bob1 = new Person('Bob');
            var bob2 = new Person('Bob');
            chai_1.expect(index_1.immutableEqual(null, null)).to.equal(true);
            chai_1.expect(index_1.immutableEqual(tom, null)).to.equal(false);
            chai_1.expect(index_1.immutableEqual(null, tom)).to.equal(false);
            chai_1.expect(index_1.immutableEqual(tom, bob1)).to.equal(false);
            chai_1.expect(index_1.immutableEqual(bob1, bob2)).to.equal(true);
        });
    });
    describe("immutableArraysEqual", function () {
        it("works", function () {
            var tom = new Person('Tom');
            var bob1 = new Person('Bob');
            var bob2 = new Person('Bob');
            chai_1.expect(index_1.immutableArraysEqual(null, null)).to.equal(true);
            chai_1.expect(index_1.immutableArraysEqual([], null)).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual([tom], null)).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual(null, [])).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual(null, [tom])).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual([tom], [])).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual([tom], [bob1])).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual([bob1, null], [bob1, tom])).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual([bob1, tom], [bob1, null])).to.equal(false);
            chai_1.expect(index_1.immutableArraysEqual([], [])).to.equal(true);
            chai_1.expect(index_1.immutableArraysEqual([bob1], [bob2])).to.equal(true);
            chai_1.expect(index_1.immutableArraysEqual([bob1, tom], [bob2, tom])).to.equal(true);
        });
    });
    describe("immutableLookupsEqual", function () {
        it("works", function () {
            var tom = new Person('Tom');
            var bob1 = new Person('Bob');
            var bob2 = new Person('Bob');
            chai_1.expect(index_1.immutableLookupsEqual(null, null)).to.equal(true);
            chai_1.expect(index_1.immutableLookupsEqual({}, null)).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual({ a: tom }, null)).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual(null, {})).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual(null, { a: tom })).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual({ a: tom }, {})).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual({ a: tom }, { a: bob1 })).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual({ a: bob1, b: null }, { a: bob1, b: tom })).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual({ a: bob1, b: tom }, { a: bob1, b: null })).to.equal(false);
            chai_1.expect(index_1.immutableLookupsEqual({}, {})).to.equal(true);
            chai_1.expect(index_1.immutableLookupsEqual({ a: bob1 }, { a: bob2 })).to.equal(true);
            chai_1.expect(index_1.immutableLookupsEqual({ a: bob1, b: tom }, { a: bob2, b: tom })).to.equal(true);
        });
    });
});
